-- users table
CREATE TABLE users (
    user_id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(10),
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    phone VARCHAR(20),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- products table 
CREATE TABLE products (
    product_id INT PRIMARY KEY AUTO_INCREMENT,
    product_name VARCHAR(255) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    stock_quantity INT NOT NULL DEFAULT 0,
    category VARCHAR(100),
    description TEXT,
    image_url VARCHAR(500)
);

-- shopping cart table 
CREATE TABLE cart (
    cart_id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    product_id INT NOT NULL,
    quantity INT NOT NULL DEFAULT 1,
    added_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,
    FOREIGN KEY (product_id) REFERENCES products(product_id) ON DELETE CASCADE
);

-- orders table
CREATE TABLE orders (
    order_id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    total_amount DECIMAL(10,2) NOT NULL,
    status VARCHAR(50) DEFAULT 'Processing',
    shipping_address TEXT,
    billing_address TEXT,
    payment_method VARCHAR(100),
    FOREIGN KEY (user_id) REFERENCES users(user_id)
);

-- order items table
CREATE TABLE order_items (
    order_item_id INT PRIMARY KEY AUTO_INCREMENT,
    order_id INT NOT NULL,
    product_id INT NOT NULL,
    quantity INT NOT NULL,
    unit_price DECIMAL(10,2) NOT NULL,
    total_price DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (order_id) REFERENCES orders(order_id),
    FOREIGN KEY (product_id) REFERENCES products(product_id)
);

-- user addresses table
CREATE TABLE user_addresses (
    address_id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    address_type ENUM('shipping', 'billing') DEFAULT 'shipping',
    address_line1 VARCHAR(255) NOT NULL,
    address_line2 VARCHAR(255),
    city VARCHAR(100) NOT NULL,
    postcode VARCHAR(20) NOT NULL,
    country VARCHAR(100) DEFAULT 'United Kingdom',
    is_default BOOLEAN DEFAULT FALSE,
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE
);

-- Insert sample products
INSERT INTO products (product_name, price, stock_quantity, category, description) VALUES
('Gaming Mouse Pro', 99.99, 50, 'Mice', 'High-precision gaming mouse with customizable RGB lighting'),
('Mechanical Keyboard', 139.99, 30, 'Keyboards', 'Mechanical keyboard with tactile switches and programmable keys'),
('Wireless Headset', 99.99, 25, 'Headsets', 'Surround sound headset with noise-cancelling microphone'),
('Premium Keyboard', 199.99, 15, 'Keyboards', 'Advanced mechanical keyboard with macro keys and wrist rest'),
('Basic Gaming Mouse', 29.99, 75, 'Mice', 'Affordable gaming mouse with reliable optical sensor'),
('Pro Headset', 129.99, 20, 'Headsets', 'High-quality headset with detachable microphone and comfort fit'),
('Curved Monitor', 699.99, 10, 'Monitors', 'Large curved monitor with high refresh rate and vibrant colours'),
('HD Webcam', 69.99, 40, 'Webcams', 'Full HD webcam with autofocus and built-in microphone'),
('Wireless Gaming Mouse', 149.99, 35, 'Mice', 'Lightweight wireless mouse with long battery life and fast response'),
('Studio Microphone', 129.99, 18, 'Audio', 'Studio-quality microphone for streaming and recording');